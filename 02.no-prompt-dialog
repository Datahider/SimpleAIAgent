<?php

use losthost\SimpleAI\SimpleAIAgent;
use losthost\DB\DB;
use losthost\SimpleAI\data\Context;

require 'vendor/autoload.php';
require 'etc/config.php'; // set $deepseek_api_key and $db_* vars

// SimpleAIAgent uses losthost\DB\DB to access it's database
DB::connect($db_host, $db_user, $db_pass, $db_name, $db_prefix);

$agent = SimpleAIAgent::build($deepseek_api_key)
        ->setAgentName('no prompt') // any name you want (you can have many agents with different prompts)
        ->setUserId(1);

while (true) {
    
    $input = '';
    echo "\n\n> ";
    while (substr($input, -3) != "\n\n\n") {
        $input .= readline(). "\n";
    }
    
    echo "\033[1;34mthinking...\033[0m\n";
    echo "\033[34m". $agent->ask($input, 'An error ocurred'). "\033[0m";
}
